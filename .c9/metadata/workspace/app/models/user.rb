{"filter":false,"title":"user.rb","tooltip":"/app/models/user.rb","undoManager":{"stack":[[{"start":{"row":1,"column":2},"end":{"row":1,"column":43},"action":"remove","lines":["has_many :microposts, dependent: :destroy"],"id":1364},{"start":{"row":1,"column":2},"end":{"row":4,"column":55},"action":"insert","lines":["has_many :microposts, dependent: :destroy","  has_many :active_relationships, class_name:  \"Relationship\",","                                  foreign_key: \"follower_id\",","                                  dependent:   :destroy"]}],[{"start":{"row":4,"column":55},"end":{"row":5,"column":0},"action":"insert","lines":["",""],"id":1365},{"start":{"row":5,"column":0},"end":{"row":5,"column":34},"action":"insert","lines":["                                  "]}],[{"start":{"row":5,"column":32},"end":{"row":5,"column":34},"action":"remove","lines":["  "],"id":1366}],[{"start":{"row":5,"column":30},"end":{"row":5,"column":32},"action":"remove","lines":["  "],"id":1367}],[{"start":{"row":5,"column":0},"end":{"row":5,"column":2},"action":"insert","lines":["  "],"id":1368}],[{"start":{"row":5,"column":2},"end":{"row":5,"column":72},"action":"insert","lines":["has_many :following, through: :active_relationships, source: :followed"],"id":1369}],[{"start":{"row":79,"column":5},"end":{"row":80,"column":0},"action":"insert","lines":["",""],"id":1370},{"start":{"row":80,"column":0},"end":{"row":80,"column":2},"action":"insert","lines":["  "]}],[{"start":{"row":80,"column":2},"end":{"row":81,"column":0},"action":"insert","lines":["",""],"id":1371},{"start":{"row":81,"column":0},"end":{"row":81,"column":2},"action":"insert","lines":["  "]}],[{"start":{"row":81,"column":2},"end":{"row":94,"column":5},"action":"insert","lines":["  # Follows a user.","  def follow(other_user)","    active_relationships.create(followed_id: other_user.id)","  end","","  # Unfollows a user.","  def unfollow(other_user)","    active_relationships.find_by(followed_id: other_user.id).destroy","  end","","  # Returns true if the current user is following the other user.","  def following?(other_user)","    following.include?(other_user)","  end"],"id":1372}],[{"start":{"row":1,"column":2},"end":{"row":5,"column":72},"action":"remove","lines":["has_many :microposts, dependent: :destroy","  has_many :active_relationships, class_name:  \"Relationship\",","                                  foreign_key: \"follower_id\",","                                  dependent:   :destroy","  has_many :following, through: :active_relationships, source: :followed"],"id":1374},{"start":{"row":1,"column":2},"end":{"row":9,"column":73},"action":"insert","lines":["has_many :microposts, dependent: :destroy","  has_many :active_relationships,  class_name:  \"Relationship\",","                                   foreign_key: \"follower_id\",","                                   dependent:   :destroy","  has_many :passive_relationships, class_name:  \"Relationship\",","                                   foreign_key: \"followed_id\",","                                   dependent:   :destroy","  has_many :following, through: :active_relationships,  source: :followed","  has_many :followers, through: :passive_relationships, source: :follower"]}],[{"start":{"row":9,"column":73},"end":{"row":9,"column":103},"action":"remove","lines":["                              "],"id":1375},{"start":{"row":9,"column":73},"end":{"row":10,"column":0},"action":"insert","lines":["",""]},{"start":{"row":10,"column":0},"end":{"row":10,"column":2},"action":"insert","lines":["  "]}],[{"start":{"row":1,"column":43},"end":{"row":2,"column":0},"action":"insert","lines":["",""],"id":1376},{"start":{"row":2,"column":0},"end":{"row":2,"column":2},"action":"insert","lines":["  "]}],[{"start":{"row":2,"column":0},"end":{"row":2,"column":2},"action":"remove","lines":["  "],"id":1377}],[{"start":{"row":1,"column":43},"end":{"row":2,"column":0},"action":"remove","lines":["",""],"id":1378}],[{"start":{"row":11,"column":64},"end":{"row":12,"column":0},"action":"insert","lines":["",""],"id":1379},{"start":{"row":12,"column":0},"end":{"row":12,"column":2},"action":"insert","lines":["  "]}],[{"start":{"row":14,"column":41},"end":{"row":15,"column":0},"action":"insert","lines":["",""],"id":1380},{"start":{"row":15,"column":0},"end":{"row":15,"column":2},"action":"insert","lines":["  "]}],[{"start":{"row":82,"column":2},"end":{"row":86,"column":5},"action":"remove","lines":["# Defines a proto-feed.","  # See \"Following users\" for the full implemenation.","  def feed","    Micropost.where(\"user_id = ?\", id)","  end"],"id":1383},{"start":{"row":82,"column":2},"end":{"row":85,"column":5},"action":"insert","lines":["# Returns a user's status feed.","  def feed","    Micropost.where(\"user_id IN (?) OR user_id = ?\", following_ids, id)","  end"]}],[{"start":{"row":84,"column":4},"end":{"row":84,"column":71},"action":"remove","lines":["Micropost.where(\"user_id IN (?) OR user_id = ?\", following_ids, id)"],"id":1384},{"start":{"row":84,"column":4},"end":{"row":85,"column":62},"action":"insert","lines":["Micropost.where(\"user_id IN (:following_ids) OR user_id = :user_id\",","                    following_ids: following_ids, user_id: id)"]}],[{"start":{"row":84,"column":4},"end":{"row":85,"column":62},"action":"remove","lines":["Micropost.where(\"user_id IN (:following_ids) OR user_id = :user_id\",","                    following_ids: following_ids, user_id: id)"],"id":1385},{"start":{"row":84,"column":4},"end":{"row":87,"column":57},"action":"insert","lines":["following_ids = \"SELECT followed_id FROM relationships","                     WHERE  follower_id = :user_id\"","    Micropost.where(\"user_id IN (#{following_ids})","                     OR user_id = :user_id\", user_id: id)"]}]],"mark":18,"position":18},"ace":{"folds":[],"scrolltop":900,"scrollleft":0,"selection":{"start":{"row":87,"column":57},"end":{"row":87,"column":57},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":63,"state":"start","mode":"ace/mode/ruby"}},"timestamp":1432309484384,"hash":"92895b7a7c6ffa7c6868f528c2e2832977113357"}